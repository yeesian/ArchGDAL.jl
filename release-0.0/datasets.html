<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>GDAL Datasets · ArchGDAL.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ArchGDAL.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">ArchGDAL.jl documentation</a></li><li class="current"><a class="toctext" href="datasets.html">GDAL Datasets</a><ul class="internal"><li><a class="toctext" href="#Vector-Datasets-1">Vector Datasets</a></li><li><a class="toctext" href="#Raster-Datasets-1">Raster Datasets</a></li><li><a class="toctext" href="#Driver-Management-1">Driver Management</a></li><li><a class="toctext" href="#Working-with-Files-1">Working with Files</a></li></ul></li><li><a class="toctext" href="features.html">Feature Data</a></li><li><a class="toctext" href="rasters.html">Raster Data</a></li><li><a class="toctext" href="geometries.html">Geometric Operations</a></li><li><a class="toctext" href="projections.html">Spatial Projections</a></li><li><a class="toctext" href="memory.html">Memory Management</a></li><li><a class="toctext" href="spatialite.html">Working with Spatialite</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="datasets.html">GDAL Datasets</a></li></ul><a class="edit-page" href="https://github.com/yeesian/ArchGDAL.jl/blob/master/docs/src/datasets.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>GDAL Datasets</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="GDAL-Datasets-1" href="#GDAL-Datasets-1">GDAL Datasets</a></h1><p>The following code demonstrates the general workflow for reading in a dataset:</p><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filename) do dataset
        # work with dataset
    end
end</code></pre><p>We defer the discussions on <code>ArchGDAL.registerdrivers()</code> and <code>ArchGDAL.read(filename)</code> to the sections on <a href="datasets.html#Driver-Management-1">Driver Management</a> and <a href="datasets.html#Working-with-Files-1">Working with Files</a> respectively.</p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>In this case, a handle to the dataset is obtained, and no further data was requested. It is only when we run <code>print(dataset)</code> that calls will be made through GDAL&#39;s C API to obtain information about <code>dataset</code> for display.</p></div></div><h2><a class="nav-anchor" id="Vector-Datasets-1" href="#Vector-Datasets-1">Vector Datasets</a></h2><div></div><p>In this section, we work with the <a href="https://github.com/yeesian/ArchGDALDatasets/blob/307f8f0e584a39a050c042849004e6a2bd674f99/data/point.geojson"><code>data/point.geojson</code></a> dataset via</p><pre><code class="language-">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        print(dataset)
    end
end</code></pre><p>The display indicates</p><ul><li><p>the <strong>type</strong> of the object (<code>GDAL Dataset</code>)</p></li><li><p>the <strong>driver</strong> used to open it (shortname/longname: <code>GeoJSON/GeoJSON</code>)</p></li><li><p>the <strong>files</strong> that it corresponds to (<code>point.geojson</code>)</p></li><li><p>the <strong>number of layers</strong> in the dataset, and their brief summary.</p></li></ul><p>You can also programmatically retrieve them using</p><ul><li><p><code>typeof(dataset)</code>: the <strong>type</strong> of the object</p></li><li><p><code>ArchGDAL.filelist(dataset)</code>: the <strong>files</strong> that it corresponds to</p></li><li><p><code>ArchGDAL.nlayer(dataset)</code>: the <strong>number of layers</strong> in the dataset</p></li><li><p><code>drv = ArchGDAL.getdriver(dataset)</code>: the <strong>driver</strong> used to open it</p></li><li><p><code>ArchGDAL.shortname(drv)</code>: the short name of a driver</p></li><li><p><code>ArchGDAL.longname(drv)</code>: the long name of a driver</p></li><li><p><code>layer = ArchGDAL.getlayer(dataset, i)</code>: the <code>i</code>-th layer in <code>dataset</code>.</p></li><li><p><code>ArchGDAL.getgeomtype(layer)</code>: the geometry type for <code>layer</code> (i.e. <code>wkbPoint</code>)</p></li><li><p><code>ArchGDAL.getname(layer)</code>: the name of <code>layer</code> (i.e. <code>OGRGeoJSON</code>)</p></li><li><p><code>ArchGDAL.nfeature(layer)</code>: the number of features in <code>layer</code> (i.e. <code>4</code>)</p></li></ul><p>For more on working with features and vector data, see the Section on <code>Feature Data</code>.</p><h2><a class="nav-anchor" id="Raster-Datasets-1" href="#Raster-Datasets-1">Raster Datasets</a></h2><div></div><p>In this section, we work with the <a href="https://github.com/yeesian/ArchGDALDatasets/blob/307f8f0e584a39a050c042849004e6a2bd674f99/gdalworkshop/world.tif"><code>gdalworkshop/world.tif</code></a> dataset:</p><pre><code class="language-">ArchGDAL.registerdrivers() do
    ArchGDAL.read(filepath) do dataset
        print(dataset)
    end
end</code></pre><p>The display indicates</p><ul><li><p>the <strong>type</strong> of the object (<code>GDAL Dataset</code>)</p></li><li><p>the <strong>driver</strong> used to open it (shortname/longname: <code>GTiff/GeoTIFF</code>)</p></li><li><p>the <strong>files</strong> that it corresponds to (<code>world.tif</code>)</p></li><li><p>the <strong>number of raster bands</strong> in the dataset, and their brief summary.</p></li></ul><p>You can also programmatically retrieve them using</p><ul><li><p><code>typeof(dataset)</code>: the type of the object</p></li><li><p><code>ArchGDAL.filelist(dataset)</code>: the files that it corresponds to</p></li><li><p><code>ArchGDAL.nraster(dataset)</code>: the number of rasters</p></li><li><p><code>ArchGDAL.width(dataset)</code> the width (<code>2048</code> pixels)</p></li><li><p><code>ArchGDAL.height(dataset)</code> the height (<code>1024</code> pixels)</p></li><li><p><code>drv = ArchGDAL.getdriver(dataset)</code>: the driver used to open it</p></li><li><p><code>ArchGDAL.shortname(drv)</code>: the short name of a driver</p></li><li><p><code>ArchGDAL.longname(drv)</code>: the long name of a driver</p></li><li><p><code>band = ArchGDAL.getband(dataset, i)</code>: the <code>i</code>-th raster band</p></li><li><p><code>i = ArchGDAL.getnumber(band)</code>: the index of <code>band</code>.</p></li><li><p><code>ArchGDAL.getaccess(band)</code>: the access flag (i.e. <code>GA_ReadOnly</code>)</p></li><li><p><code>ArchGDAL.getname(ArchGDAL.getcolorinterp(rasterband))</code>: the color channel (e.g. <code>Red</code>)</p></li><li><p><code>ArchGDAL.width(band)</code> the width (<code>2048</code> pixels) of the band</p></li><li><p><code>ArchGDAL.height(band)</code> the height (<code>1024</code> pixels) of the band</p></li><li><p><code>ArchGDAL.getdatatype(band)</code>: the pixel type (i.e. <code>UInt8</code>)</p></li></ul><p>For more on working with raster data, see the Section on <code>Raster Data</code>.</p><h2><a class="nav-anchor" id="Driver-Management-1" href="#Driver-Management-1">Driver Management</a></h2><p>Before opening a GDAL supported datastore it is necessary to register drivers. Normally this is accomplished with the <code>GDAL.allregister()</code> function which registers all known drivers. However, the user will then need to remember to de-register the drivers using <code>GDAL.destroydrivermanager()</code> when they&#39;re done.</p><p>In ArchGDAL, we provide a <code>registerdrivers()</code> block, such that</p><pre><code class="language-julia">ArchGDAL.registerdrivers() do
    # your code here
end</code></pre><p>is equivalent to</p><pre><code class="language-julia">GDAL.allregister()
# your code here
GDAL.destroydrivermanager()</code></pre><h2><a class="nav-anchor" id="Working-with-Files-1" href="#Working-with-Files-1">Working with Files</a></h2><p>We provide the following methods for working with files:</p><ul><li><p><code>ArchGDAL.createcopy()</code>: create a copy of a raster dataset. This is often used with a virtual source dataset allowing configuration of band types, and other information without actually duplicating raster data.</p></li><li><p><code>ArchGDAL.create()</code>: creates a new dataset Note: many sequential write-once formats (such as JPEG and PNG) don&#39;t implement the <code>Create()</code> method but do implement the <code>CreateCopy()</code> method. If the driver doesn&#39;t implement <code>CreateCopy()</code>, but does implement <code>Create()</code> then the default <code>CreateCopy()</code> mechanism built on calling <code>Create()</code> will be used.</p></li><li><p><code>ArchGDAL.read()</code>: opens a dataset in read-only mode. The returned dataset should only be accessed by one thread at a time. To use it from different threads, you must add all necessary code (mutexes, etc.) to avoid concurrent use of the object. (Some drivers, such as GeoTIFF, maintain internal state variables that are updated each time a new block is read, preventing concurrent use.)</p></li><li><p><code>ArchGDAL.update()</code>: opens a dataset with the possibility of updating it. If you open a dataset object with update access, it is not recommended to open a new dataset on the same underlying file.</p></li></ul><p>For each one of them, we will call <code>ArchGDAL.destroy</code> at the end of the <code>do</code>-block which will dispatch to the corresponding GDAL method. For example,</p><pre><code class="language-julia">ArchGDAL.read(filename) do dataset
    # work with dataset
end</code></pre><p>will correspond to</p><pre><code class="language-julia">dataset = ArchGDAL.unsafe_read(filename)
# work with dataset
ArchGDAL.destroy(dataset) # the equivalent of GDAL.close(dataset.ptr)</code></pre><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>In GDAL, datasets are closed by calling <code>GDAL.close()</code>. This will result in proper cleanup, and flushing of any pending writes. Forgetting to call <code>GDAL.close()</code> on a dataset opened in update mode in a popular format like <code>GTiff</code> will likely result in being unable to open it afterwards.</p></div></div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>This pattern of using <code>do</code>-blocks to manage context plays a big way into the way we handle memory in this package. For details, see the section on Memory Management.</p></div></div><footer><hr/><a class="previous" href="index.html"><span class="direction">Previous</span><span class="title">ArchGDAL.jl documentation</span></a><a class="next" href="features.html"><span class="direction">Next</span><span class="title">Feature Data</span></a></footer></article></body></html>
